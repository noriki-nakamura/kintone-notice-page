---
import Layout from '../layouts/Layout.astro';
import { getNotices } from '../lib/kintone';
import GoogleCalendar from '../components/GoogleCalendar.astro';

const notices = await getNotices();
---

<Layout title="お知らせ一覧">
  <div class="content-wrapper">
    <div class="calendar-section">
      <GoogleCalendar />
    </div>

    <div class="notices-section">
      <h2>お知らせ一覧</h2>
      {notices.length === 0 ? (
        <p>お知らせはありません。</p>
      ) : (
        <ul class="notice-list">
          {notices.map((notice) => (
            <li>
              <a href={`/notice/${notice.id}`}>
                <span class="date">{notice.publishedAt}</span>
                <span class="category">[{notice.category}]</span>
                <span class="title">{notice.title}</span>
              </a>
            </li>
          ))}
        </ul>
      )}
    </div>
  </div>

  <style>
    .content-wrapper {
      display: grid;
      grid-template-columns: 1fr 1fr; /* 1:1 split */
      gap: 4rem;
      align-items: start;
    }

    /* Mobile: Stack vertically */
    @media (max-width: 768px) {
      .content-wrapper {
        grid-template-columns: 1fr;
      }
    }

    .calendar-section, .notices-section {
      background: white;
      border-radius: 8px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
      padding: 1.5rem;
      /* border: 1px solid #ddd; - Replaced by box-shadow for cleaner card look */
    }

    .notice-list {
      list-style: none;
      padding: 0;
    }
    .notice-list li {
      border-bottom: 1px solid #eee;
      padding: 1rem 0;
    }
    .notice-list li:last-child {
      border-bottom: none;
    }
    .date {
      color: #666;
      font-size: 0.9rem;
      margin-right: 0.5rem;
      display: inline-block; /* Ensure date doesn't break weirdly */
    }
    .category {
      color: #007bff;
      font-weight: bold;
      margin-right: 0.5rem;
    }
    .title {
      font-size: 1.1rem;
      font-weight: bold;
      display: block; /* Title on new line for better readability in columns */
      margin-top: 0.2rem;
    }
    a {
      text-decoration: none;
      color: inherit;
      display: block; /* Make whole list item clickable area nicer */
    }
    a:hover .title {
      color: #0056b3;
    }
  </style>
</Layout>
